FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczog\
CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQWVyb0dlYXIgVVBT\
CiAgaW1hZ2VVcmw6ICJodHRwczovL3Bicy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5NDQ0\
MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0\
dHBzOi8vYWVyb2dlYXIub3JnL3B1c2giCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQs\
IEluYy4iCiAgZGVwZW5kZW5jaWVzOiBbJ015U1FMOjU1J10KICBzZXJ2aWNlTmFtZTogdXBzCnBs\
YW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlcGxveSBVUFMKICAgIGZy\
ZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczogCiAgICAtIG5hbWU6IE1Z\
U1FMX1VTRVIKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogdW5pZmllZHB1c2gK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGIgdXNlcm5hbWUKICAgIC0gbmFt\
ZTogTVlTUUxfUEFTU1dPUkQKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogdW5p\
ZmllZHB1c2gKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGIgcGFzc3dvcmQK\
ICAgIC0gbmFtZTogTVlTUUxfUk9PVF9QQVNTV09SRAogICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICBkZWZhdWx0OiBzdXBlcnNlY3JldAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFVQ\
UyBkYiByb290IHBhc3N3b3JkCiAgICAtIG5hbWU6IE1ZU1FMX0RBVEFCQVNFCiAgICAgIHJlcXVp\
cmVkOiBUcnVlCiAgICAgIGRlZmF1bHQ6IHVuaWZpZWRwdXNoCiAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICB0aXRsZTogVVBTIGRhdGFiYXNlIG5hbWUKICAgIC0gbmFtZTogTVlTUUxfVkVSU0lPTgog\
ICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZhdWx0OiAiNTUiCiAgICAgIGVudW06IFsnNTUn\
LCAnNTYnXQogICAgICB0eXBlOiBlbnVtCiAgICAgIHRpdGxlOiBNeVNRTCB2ZXJzaW9u"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
