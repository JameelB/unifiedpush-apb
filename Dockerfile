FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczog\
CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQWVyb0dlYXIgVVBT\
CiAgaW1hZ2VVcmw6ICJodHRwczovL3Bicy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5NDQ0\
MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0\
dHBzOi8vYWVyb2dlYXIub3JnL3B1c2giCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQs\
IEluYy4iCiAgZGVwZW5kZW5jaWVzOiBbJ015U1FMOjU1J10KICBzZXJ2aWNlTmFtZTogdXBzCnBs\
YW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlcGxveSBVUFMKICAgIGZy\
ZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczogCiAgICAtIG5hbWU6IE1Z\
U1FMX1VTRVIKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogdW5pZmllZHB1c2gK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGIgdXNlcm5hbWUKICAgIC0gbmFt\
ZTogX01ZU1FMX1BBU1NXT1JECiAgICAgIGRlc2NyaXB0aW9uOiAoZ2VuZXJhdGVkIGlmIGxlZnQg\
YmxhbmspCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IFVQUyBkYiBwYXNzd29yZAogICAgLSBuYW1lOiBfTVlTUUxfUk9PVF9QQVNTV09SRAogICAg\
ICBkZXNjcmlwdGlvbjogKGdlbmVyYXRlZCBpZiBsZWZ0IGJsYW5rKQogICAgICByZXF1aXJlZDog\
RmFsc2UKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGIgcm9vdCBwYXNzd29y\
ZAogICAgLSBuYW1lOiBNWVNRTF9EQVRBQkFTRQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBk\
ZWZhdWx0OiB1bmlmaWVkcHVzaAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFVQUyBk\
YXRhYmFzZSBuYW1lCiAgICAtIG5hbWU6IE1ZU1FMX1ZFUlNJT04KICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgICAgZGVmYXVsdDogIjU1IgogICAgICBlbnVtOiBbJzU1JywgJzU2J10KICAgICAgdHlw\
ZTogZW51bQogICAgICB0aXRsZTogTXlTUUwgdmVyc2lvbg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
