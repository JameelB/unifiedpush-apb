FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBBZXJvR2VhciBVUFMK\
ICBpbWFnZVVybDogImh0dHBzOi8vcGJzLnR3aW1nLmNvbS9wcm9maWxlX2ltYWdlcy8xNzk0NDQw\
MDA1L2Flcm9nZWFyX2ljb24tMV80MDB4NDAwLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0\
cHM6Ly9hZXJvZ2Vhci5vcmcvcHVzaCIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwg\
SW5jLiIKICBzZXJ2aWNlTmFtZTogdXBzCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVz\
Y3JpcHRpb246IERlcGxveSBVUFMKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAg\
cGFyYW1ldGVyczogCiAgICAtIG5hbWU6IE1ZU1FMX1VTRVIKICAgICAgcmVxdWlyZWQ6IFRydWUK\
ICAgICAgZGVmYXVsdDogdW5pZmllZHB1c2gKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxl\
OiBVUFMgZGIgdXNlcm5hbWUKICAgIC0gbmFtZTogTVlTUUxfUEFTU1dPUkQKICAgICAgcmVxdWly\
ZWQ6IFRydWUKICAgICAgZGVmYXVsdDogdW5pZmllZHB1c2gKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIHRpdGxlOiBVUFMgZGIgcGFzc3dvcmQKICAgIC0gbmFtZTogTVlTUUxfUk9PVF9QQVNTV09S\
RAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZhdWx0OiBzdXBlcnNlY3JldAogICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFVQUyBkYiByb290IHBhc3N3b3JkCiAgICAtIG5hbWU6\
IE1ZU1FMX0RBVEFCQVNFCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIGRlZmF1bHQ6IHVuaWZp\
ZWRwdXNoCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogVVBTIGRhdGFiYXNlIG5hbWUK\
ICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTogc2VydmljZQogICAgICB0aXRsZTogVGhl\
IHNlcnZpY2UgdGhlIGNsaWVudCBpcyBmb3IKICAgICAgdHlwZTogc3RyaW5nCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
