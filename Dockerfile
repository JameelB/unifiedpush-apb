FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBBZXJvR2VhciBVUFMK\
ICBpbWFnZVVybDogImh0dHBzOi8vcGJzLnR3aW1nLmNvbS9wcm9maWxlX2ltYWdlcy8xNzk0NDQw\
MDA1L2Flcm9nZWFyX2ljb24tMV80MDB4NDAwLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0\
cHM6Ly9hZXJvZ2Vhci5vcmcvcHVzaCIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwg\
SW5jLiIKICBkZXBlbmRlbmNpZXM6IFsnUE9TVEdSRVM6OTUnXQogIHNlcnZpY2VOYW1lOiB1cHMK\
cGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogRGVwbG95IFVQUwogICAg\
ZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOiBbXQogICAgYmluZF9w\
YXJhbWV0ZXJzOgogICAgLSBuYW1lOiBjbGllbnRJZAogICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICB0aXRsZTogVGhlIElEIG9mIHRoZSBtb2JpbGUgY2xpZW50IHRvIGJpbmQgdGhpcyB2YXJpYW50\
IHRvCiAgICAgIHR5cGU6IHN0cmluZwogICAgLSBuYW1lOiB0eXBlCiAgICAgIHJlcXVpcmVkOiBU\
cnVlCiAgICAgIHRpdGxlOiBBcHAgdGFyZ2V0CiAgICAgIHR5cGU6IGVudW0KICAgICAgZGVmYXVs\
dDogIkFuZHJvaWQiCiAgICAgIGVudW06IFsiQW5kcm9pZCJdCiAgICAtIG5hbWU6IGdvb2dsZWtl\
eQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0aXRsZTogWW91ciBHb29nbGUgS2V5IGZvciBG\
aXJlYmFzZSBDbG91ZCBNZXNzYWdpbmcKICAgICAgdHlwZTogc3RyaW5nCiAgICAtIG5hbWU6IHBy\
b2plY3ROdW1iZXIKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgdGl0bGU6IFlvdXIgRkNNIFBy\
b2plY3QgTnVtYmVyLCBuZWVkZWQgb24gdGhlIG1vYmlsZSBjbGllbnQgZm9yIGNvbm5lY3Rpbmcg\
d2l0aCBGQ00KICAgICAgdHlwZTogc3RyaW5nCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
