FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBBZXJvR2VhciBVbmlm\
aWVkIFB1c2ggU2VydmVyIChVUFMpCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW4gQVBCIGRlcGxveWlu\
ZyB0aGUgQWVyb0dlYXIgVW5pZmllZFB1c2ggU2VydmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdl\
IGFuZCBhdXRoZW50aWNhdGlvbiB0aHJvdWdoIE9wZW5zaGlmdCIKICBpbWFnZVVybDogImh0dHBz\
Oi8vcGJzLnR3aW1nLmNvbS9wcm9maWxlX2ltYWdlcy8xNzk0NDQwMDA1L2Flcm9nZWFyX2ljb24t\
MV80MDB4NDAwLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9naXRodWIuY29tL2Fl\
cm9nZWFyY2F0YWxvZy91bmlmaWVkcHVzaC1hcGIvYmxvYi9tYXN0ZXIvZG9jcy9tb2R1bGVzL3Vw\
c19vcGVuc2hpZnQvaW5kZXguYXNjaWlkb2MiCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBI\
YXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOgogICAgLSAiZG9ja2VyLmlvL2Flcm9nZWFyL3VuaWZp\
ZWRwdXNoLXdpbGRmbHktcGxhaW46Mi4wLjEiCiAgICAtICJkb2NrZXIuaW8vY2VudG9zL3Bvc3Rn\
cmVzcWwtOTYtY2VudG9zNzo5LjYiCiAgICAtICJkb2NrZXIuaW8vYWVyb2dlYXIvdXBzLWNvbmZp\
Zy1vcGVyYXRvcjptYXN0ZXIiCiAgICAtICJkb2NrZXIuaW8vb3BlbnNoaWZ0L29hdXRoLXByb3h5\
OnYxLjEuMCIKICBzZXJ2aWNlTmFtZTogdXBzCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAg\
ZGVzY3JpcHRpb246IFBlcnNpc3RlbnQgZGVwbG95bWVudCBvZiBVUFMKICAgIGZyZWU6IFRydWUK\
ICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczogW10KICAgIGJpbmRfcGFyYW1ldGVyczoK\
ICAgIC0gbmFtZTogY2xpZW50SWQKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgdGl0bGU6IFRo\
ZSBJRCBvZiB0aGUgbW9iaWxlIGNsaWVudCB0byBiaW5kIHRoaXMgdmFyaWFudCB0bwogICAgICB0\
eXBlOiBzdHJpbmcKICAgIC0gbmFtZTogdHlwZQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0\
aXRsZTogQXBwIHRhcmdldAogICAgICB0eXBlOiBlbnVtCiAgICAgIGRlZmF1bHQ6ICJBbmRyb2lk\
IgogICAgICBlbnVtOiBbIkFuZHJvaWQiLCAiSU9TIl0KICAgIC0gbmFtZTogZ29vZ2xla2V5CiAg\
ICAgIHRpdGxlOiBZb3VyIEdvb2dsZSBLZXkgZm9yIEZpcmViYXNlIENsb3VkIE1lc3NhZ2luZwog\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91cDogQW5kcm9pZAogICAgLSBuYW1l\
OiBwcm9qZWN0TnVtYmVyCiAgICAgIHRpdGxlOiBZb3VyIEZDTSBQcm9qZWN0IE51bWJlciwgbmVl\
ZGVkIG9uIHRoZSBtb2JpbGUgY2xpZW50IGZvciBjb25uZWN0aW5nIHdpdGggRkNNCiAgICAgIHR5\
cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBBbmRyb2lkCiAgICAtIG5hbWU6IGNlcnQK\
ICAgICAgdGl0bGU6IGlPUyAucDEyIGZpbGUgKGVuY29kZSBjb250ZW50cyBpbiBiYXNlNjQgYmVm\
b3JlIHBhc3RpbmcpCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X3R5cGU6IHRleHRh\
cmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IGlPUwogICAgLSBuYW1lOiBwYXNzcGhyYXNlCiAgICAg\
IHRpdGxlOiB0aGUgcGFzc3BocmFzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90\
eXBlOiBwYXNzd29yZAogICAgICBkaXNwbGF5X2dyb3VwOiBpT1MK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
